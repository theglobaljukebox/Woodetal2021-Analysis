mtcars.pca <- prcomp(mtcars[,c(1:7,10,11)], center = TRUE,scale. = TRUE)
mtcars.pca
mtcars.pca
summary(mtcars.pcs)
summary(mtcars.pca)
summary(mtcars.pca)
str(mtcars.pca)
install.packages("ggbiplot")
library(devtools)
install_github("vqv/ggbiplot")
library(devtools)
library("devtools")
install.packages("devtools")
clear
cls
library("devtools")
library(devtools)
install_github("vqv/ggbiplot")
library(ggbiplot)
ggbiplot(mtcars.pca)
ggbiplot(mtcars.pca, labels=rownames(mtcars))
ggbiplot(mtcars.pca,ellipse=TRUE,obs.scale = 1, var.scale = 1,  labels=rownames(mtcars), groups=mtcars.country) +
scale_colour_manual(name="Origin", values= c("forest green", "red3", "dark blue"))+
ggtitle("PCA of mtcars dataset")+
theme_minimal()+
theme(legend.position = "bottom")
mtcars.country <- c(rep("Japan", 3), rep("US",4), rep("Europe", 7),rep("US",3), "Europe", rep("Japan", 3), rep("US",4), rep("Europe", 3), "US", rep("Europe", 3))
ggbiplot(mtcars.pca,ellipse=TRUE,obs.scale = 1, var.scale = 1,  labels=rownames(mtcars), groups=mtcars.country) +
scale_colour_manual(name="Origin", values= c("forest green", "red3", "dark blue"))+
ggtitle("PCA of mtcars dataset")+
theme_minimal()+
theme(legend.position = "bottom")
mtcars
install.packages("popr")
install.packages("poppr")
library('poppr')
data(partical_clone)
data(partial_clone)
partial_clone
as.data.frame(partial_clone)
amova
data(woodmouse)
requure(ape)
require(ape)
data(woodmoue)
data(woodmouse)
woodmouse
library(adegenet)
df <- data.frame(locusA=c("11","11","12","32"),
locusB=c(NA,"34","55","15"),locusC=c("22","22","21","22"))
row.names(df) <- .genlab("genotype",4)
df
install.packages("adegenet")
clear
library('ade4get')
library('adegenet')
row.names(df) <- .genlab("genotype",4)
df
obj <- df3genind(df, ploidy=2, ncode=1)
obj <- df2genind(df, ploidy=2, ncode=1)
obj
tab(obj)
obj <- df2genind(df, ploidy=1, ncode=1)
tab(obj)
pippr.amova(obj)
poppr.amova(obj)
library('poppr')
poppr.amova(obj)
poppr.amova(obj, hier=NULL)
poppr.amova(obj, ~Pop/Subpop)
df <- data.frame(locusA=c("11","11","12","32"),
locusB=c("11","34","55","15"),locusC=c("22","22","21","22"))
row.names(df) <- .genlab("genotype",4)
df
obj <- df2genind(df, ploidy=2, ncode=1)
poppr.amova(obj)
tab(obj)
poppr.amova(obj, ~Pop/Subpop)
df <- data.frame(locusA=c("11","11","12"),
locusB=c("11","34","55",),locusC=c("22","22","21","22"))
row.names(df) <- .genlab("genotype",4)
df
df <- data.frame(locusA=c("11","11","12"),
locusB=c("11","34","55"),locusC=c("22","21","22"))
row.names(df) <- .genlab("genotype",4)
df
df <- data.frame(locusA=c("11","11","12"),
locusB=c("11","34","55"),locusC=c("22","21","22"))
row.names(df) <- .genlab("genotype",3)
df
obj <- df2genind(df, ploidy=2, ncode=1)
tab(obj)
poppr.amova(obj, ~Pop/Subpop)
library('textshape')
library('ade4')
setwd('~/Documents/Work/Global Jukebox/')
globalCanto <- list("samples", "distances", "structures")
df <- read.csv('./data/global_samples.csv')
globalCanto$samples = subset(df, select = -c(X))
globalCanto$samples <- column_to_rownames(globalCanto$samples, "canto_coding_id")
df <- read.csv('./data/global_no_singles.csv')
df <- subset(df, select = -c(X, Culture, C_cid, orv_1,orv_2,ensemble_value_id,ensemble_value_label,instrument_value_id,instrument_value_label,Number.of.Samples))
df <- column_to_rownames(df, "canto_coding_id")
globalCanto$distances <- dist(df)
df <- read.csv('./data/global_structure.csv')
df = subset(df, select=-c(X))
factors <- df[['region']]
globalCanto$structures <- data.frame(region = as.factor(factors))
amova(globalCanto$samples, globalCanto$distances, globalCanto$structures)
globalCanto$amova <- amova(globalCanto$samples, globalCanto$distances, globalCanto$structures)
write.csv(globalCanto$amova$results, './data/amova_global_results.csv')
write.csv(globalCanto$amova$componentsofcovariance, './data/amova_global_covariance.csv')
write.csv(globalCanto$amova$statphi, './data/amova_global_statphi.csv')
