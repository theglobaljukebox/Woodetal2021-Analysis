mtcars.pca <- prcomp(mtcars[,c(1:7,10,11)], center = TRUE,scale. = TRUE)
mtcars.pca
mtcars.pca
summary(mtcars.pcs)
summary(mtcars.pca)
summary(mtcars.pca)
str(mtcars.pca)
install.packages("ggbiplot")
library(devtools)
install_github("vqv/ggbiplot")
library(devtools)
library("devtools")
install.packages("devtools")
clear
cls
library("devtools")
library(devtools)
install_github("vqv/ggbiplot")
library(ggbiplot)
ggbiplot(mtcars.pca)
ggbiplot(mtcars.pca, labels=rownames(mtcars))
ggbiplot(mtcars.pca,ellipse=TRUE,obs.scale = 1, var.scale = 1,  labels=rownames(mtcars), groups=mtcars.country) +
scale_colour_manual(name="Origin", values= c("forest green", "red3", "dark blue"))+
ggtitle("PCA of mtcars dataset")+
theme_minimal()+
theme(legend.position = "bottom")
mtcars.country <- c(rep("Japan", 3), rep("US",4), rep("Europe", 7),rep("US",3), "Europe", rep("Japan", 3), rep("US",4), rep("Europe", 3), "US", rep("Europe", 3))
ggbiplot(mtcars.pca,ellipse=TRUE,obs.scale = 1, var.scale = 1,  labels=rownames(mtcars), groups=mtcars.country) +
scale_colour_manual(name="Origin", values= c("forest green", "red3", "dark blue"))+
ggtitle("PCA of mtcars dataset")+
theme_minimal()+
theme(legend.position = "bottom")
mtcars
install.packages("popr")
install.packages("poppr")
library('poppr')
data(partical_clone)
data(partial_clone)
partial_clone
as.data.frame(partial_clone)
amova
data(woodmouse)
requure(ape)
require(ape)
data(woodmoue)
data(woodmouse)
woodmouse
library(adegenet)
df <- data.frame(locusA=c("11","11","12","32"),
locusB=c(NA,"34","55","15"),locusC=c("22","22","21","22"))
row.names(df) <- .genlab("genotype",4)
df
install.packages("adegenet")
clear
library('ade4get')
library('adegenet')
row.names(df) <- .genlab("genotype",4)
df
obj <- df3genind(df, ploidy=2, ncode=1)
obj <- df2genind(df, ploidy=2, ncode=1)
obj
tab(obj)
obj <- df2genind(df, ploidy=1, ncode=1)
tab(obj)
pippr.amova(obj)
poppr.amova(obj)
library('poppr')
poppr.amova(obj)
poppr.amova(obj, hier=NULL)
poppr.amova(obj, ~Pop/Subpop)
df <- data.frame(locusA=c("11","11","12","32"),
locusB=c("11","34","55","15"),locusC=c("22","22","21","22"))
row.names(df) <- .genlab("genotype",4)
df
obj <- df2genind(df, ploidy=2, ncode=1)
poppr.amova(obj)
tab(obj)
poppr.amova(obj, ~Pop/Subpop)
df <- data.frame(locusA=c("11","11","12"),
locusB=c("11","34","55",),locusC=c("22","22","21","22"))
row.names(df) <- .genlab("genotype",4)
df
df <- data.frame(locusA=c("11","11","12"),
locusB=c("11","34","55"),locusC=c("22","21","22"))
row.names(df) <- .genlab("genotype",4)
df
df <- data.frame(locusA=c("11","11","12"),
locusB=c("11","34","55"),locusC=c("22","21","22"))
row.names(df) <- .genlab("genotype",3)
df
obj <- df2genind(df, ploidy=2, ncode=1)
tab(obj)
poppr.amova(obj, ~Pop/Subpop)
libarary('vegan')
library('ade4')
libarary('textshape')
library('textshape')
data("humDNAm")
dim(humDNAm$samples)
dim(humDNAm$structures)
humDNAm$structures
humDNAm$samples
indianCanto <- list(samples, distances, structures)
indianCanto <- list("samples", "distances", "structures")
setwd('~/Documents/Work/Global Jukebox/')
df <- read.csv('./data/samples.csv')
df
indianCanto$samples = subset(df, select = -c(X))
indianCanto$samples <- column_to_rownames(indianCanto$samples, "canto_coding_id")
indianCanto$distances <- dist(indianCanto$samples, method="euclidean", eig=TRUE)
indianCanto$distances <- dist(indianCanto$samples, method="euclidean")
dim(as.matrix(indianCanto.distances))
dim(as.matrix(indianCanto$distances))
dim(indianCanto$samples)
i
df <- read.csv('./data/structure.csv')
df
df = subset(df, select = -c(X))
indianCanto$structures <- df
indianCanto$structures
amova(indianCanto$samples, indianCanto$distances, indianCanto$structures)
df <- read.csv('./data/indian_no_singles.csv')
df
df <- subset(df, select = -c(X, Number.of.Samples, region, division, subregion, area_kingdom, culture, lat, lng))
df
df <- columns_to_rownames(df, "canto_coding_id")
df <- column_to_rownames(df, "canto_coding_id")
df
indianCanto$distances <- dist(df)
amova(indianCanto$samples, indianCanto$distances, indianCanto$structures)
inherits(indianCanto$structures, "data.frame")
m <- match(apply(indianCanto$structures, 2, function(x) length(x)), ncol(indianCanto$samples), 0)
m
m[m==1]
ncol(indianCanto$structures)
m <- match(tapply(1:ncol(indianCanto$structures), as.factor(1:ncol(indianCanto$structures)), function(x) is.factor(indianCanto$structures[, x])), TRUE , 0)
m
indianCanto$structures <- as.factor(indianCanto$structures)
amova(indianCanto$samples, indianCanto$distances, indianCanto$structures)
indianCanto$structures
humDNAm$structures
indianCanto$structures <- as.data.frame(as.factor(indianCanto$structures))
amova(indianCanto$samples, indianCanto$distances, indianCanto$structures)
indianCanto$structures
indianCanto$structures <- data.frame(region = as.factor(c("North", "South")))
amova(indianCanto$samples, indianCanto$distances, indianCanto$structures)
indianCanto$structures
df <- read.csv('./data/structure.csv')
df = subset(df, select=-c(X))
factors <- as.vector(df)
factors
indianCanto$structures <- data.frame(region = as.factor(factors)
)
indianCanto$structures
factors <- df[['region']]
factors
indianCanto$structures <- data.frame(region = as.factor(factors)
)
indianCanto$structures
amova(indianCanto$samples, indianCanto$distances, indianCanto$structures)
indianCanto$amova <- amova(indianCanto$samples, indianCanto$distances, indianCanto$structures)
indianCanto$amova <- as.data.frame(indianCanto$amova)
indianCanto$amova$results
indianCanto$amova$componentsofcovariance
indianCanto$amova$statphi
writ.csv(indianCanto$amova$results, './output/amova_results.csv')
write.csv(indianCanto$amova$results, './output/amova_results.csv')
write.csv(indianCanto$amova$componentsofcovariance, './output/componentsofcovariance.csv')
write.csv(indianCanto$amova$statphi, './output/statphi.csv')
